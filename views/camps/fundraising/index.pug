extends /layout

block content
    .row
        .col-xs-12
            .jumbotron.clearfix
                h1 Fundraising for #[b Camp #{camp.location.name}]
                .well.well-sm.fundraising-well.text-center
                    h3 $#{total} raised total
                br
                a.btn.btn-lg.btn-primary.right(href="/camps/" + camp._id) Camp Details
            
    if user.admin || helpers.isInvolved(activeInvolvements, camp)
        hr
        if camp.active
            
            .row
                .col-xs-12.col-md-6
                    include addfunds
                .col-xs-12.col-md-6
                    include recentfunds
        else
            h3.text-muted.text-center This camp has ended so no more fundraising data can be added.
    .row
        .col-xs-12
            .page-header
                h1 Goals
        .col-xs-12
            
    .row
        .col-xs-12
            .page-header
                h2 All Funds
                    small.right #{funds.length} total
            if funds.length > 0
                table.table
                    thead
                        tr
                            th Date Added
                            th Amount/Form
                            th Method
                            th Submitted By
                    tbody
                        each f in funds
                            tr
                                th(title=moment(f.dateAdded).fromNow()) #{moment(f.dateAdded).format("MMMM Do")}
                                td $#{f.amount} #{f.form}
                                td= f.method
                                td(title=f.submittedBy.email)
                                    a(href="/users/" + f.submittedBy.email) #{f.submittedBy.name.full}
                                if user.admin || (helpers.getRankFromCamp(camp, user) != 'teacher' || (helpers.getRankFromCamp(camp, user) == 'teacher' && f.submittedBy._id == user._id))
                                    td
                                        form(action="/camps/" + camp._id + "/removefunds?fundsId=" + f._id, method="POST", onsubmit="return confirm('Are you sure you want to remove these funds?');")
                                            button.btn.btn-danger.right Remove
            else
                p.text-muted.text-center There are currently no #[b funds].