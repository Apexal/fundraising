extends /layout

block content
    .row
        .col-xs-12
            .page-header
                h1 Location 
                    b #{location.name}
                    small.right added #{moment(location.created_at).fromNow()}
    .row
        .col-xs-12.col-lg-7
            iframe.location-iframe(width="650", height="450", frameborder="0", style="border:0", src="https://www.google.com/maps/embed/v1/place?key=" + apiKey + "&q=" + location.address, allowfullscreen)
        .col-xs-12.col-lg-5
            .page-header.active-camps
                h3 Active Camps
                    +help('active-camps')
                    small.right #{activeCamps.length} total
            if activeCamps.length > 0
                each c in activeCamps
                    .panel(class=(c.ongoing ? 'panel-success' : 'panel-primary'))
                        .panel-heading
                            h1.panel-title(title=c.location.address)
                                if c.ongoing
                                    b Ongoing from 
                                span #{moment(c.startDate).format("MMMM Do")} to #{moment(c.endDate).format("MMMM Do")}
                        .panel-body
                            if c.ready
                                .rank-summary
                                    .ambassador
                                        b Ambassador - 
                                        span= c.ambassador.name.full
                                    .director
                                        b Program Director - 
                                        span= c.director.name.full
                                    .teachers
                                        b Teachers - 
                                        span #{c.teachers.length} total
                                if c.info
                                    br
                                    .well.well-sm
                                        b Camp Info
                                        p= helpers.limit(c.info, 50)
                            else
                                .well.well-sm.text-center
                                    code
                                        b Missing Ranks
                                        |  | Join now.
                            hr
                            if c.ongoing
                                b Ends #{moment(c.endDate).fromNow()}
                            else
                                b Starts #{moment(c.startDate).fromNow()}
                            a.btn.right(class=(c.ongoing ? 'btn-success' : 'btn-primary'), href="/camps/" + c._id) Camp Overview
            else
                p.text-muted.text-center There are currently no #[b active camps].
        .col-xs-12
    .row
        .col-xs-12
            .page-header
                h3 Inactive Camps
                    +help('inactive-camps')
                    small.right #{inactiveCamps.length} total
        .col-xs-12
            if inactiveCamps.length > 0
                table.table
                    thead
                        tr
                            th Start Date
                            th End Date
                            th Ambassador
                            th Program Director
                    tbody
                        each c in inactiveCamps
                            tr
                                td= moment(c.startDate).format("YYYY-MM-DD")
                                td= moment(c.endDate).format("YYYY-MM-DD")
                                td
                                    if c.ambassador
                                        a(href="/users/" + c.ambassador._id)= c.ambassador.name.full
                                    else
                                        span.text-muted None
                                td
                                    if c.director
                                        a(href="/users/" + c.director._id)= c.director.name.full
                                    else
                                        span.text-muted None
            else
                p.text-muted.text-center There are currently no #[b inactive camps].
    if user.admin
        .row
            .col-xs-12
                hr
                form(action="/locations/" + location._id + "/delete", method="POST", onsubmit="return confirm('Are you sure you want to delete this location (AND ALL ASSOCIATED CAMPS)?');")
                    button.btn.btn-danger Delete Location
                    a.btn.btn-primary(href="/locations/" + location._id + "/edit") Edit Location
